"use strict";var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}!function(e,n){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):window&&("object"!==Object.prototype.toString.call(window.zhf).slice(8,-1).toLowerCase()&&(window.zhf={}),window.zhf.EventEmitter=n())}(0,function(){return function(){function e(){_classCallCheck(this,e),this.event={},this.eventOne={}}return _createClass(e,[{key:"_bind",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments[3],o=i[e];o||(o=[],i[e]=o),o.push({isDel:!1,minNum:t,triggerNum:0,fn:n})}},{key:"_cancel",value:function(e,n,t){var i=t[e];i&&(n&&n>=1?(i[n-1].isDel=!0,!0===this._isCancelAll(i)&&(i.length=0)):i.length=0)}},{key:"_isCancelAll",value:function(e){for(var n=!0,t=0;t<e.length;t++){var i=e[t];delete i.fn.nowNum,!1===i.isDel&&(n=!1)}return n}},{key:"_cancelAll",value:function(e){Object.keys(e).forEach(function(n){e[n].length=0})}},{key:"_trigger",value:function(e,n,t,i,o){var l=i[e];if(l&&(l.allData||(l.allData=[]),l.allData.push(n),l.forEach(function(e){e.triggerNum++,e.triggerNum>=e.minNum&&!1===e.isDel&&(e.fn({nowData:n,allData:l.allData}),"once"===o&&(e.isDel=!0)),"function"===Object.prototype.toString.call(t).slice(8,-1).toLowerCase()&&(e.data=n,t(e))}),"once"===o)){var a=!0;l.forEach(function(e){!1===e.isDel&&(a=!1)}),a&&(l.length=0)}}},{key:"on",value:function(e,n,t){this._bind(e,n,t,this.event)}},{key:"addEventListener",value:function(e,n,t){this._bind(e,n,t,this.event)}},{key:"removeEventListener",value:function(e,n,t){var i=this.event[e];if(i){for(var o=0;o<i.length;o++){var l=i[o];void 0===l.fn.nowNum&&(l.fn.nowNum=0),t&&t>=1?l.fn===n&&(l.fn.nowNum++,l.fn.nowNum===t&&(l.isDel=!0)):l.fn===n&&(l.isDel=!0)}!0===this._isCancelAll(i)&&(i.length=0)}}},{key:"once",value:function(e,n,t){this._bind(e,n,t,this.eventOne)}},{key:"off",value:function(e,n,t){void 0===t?e?(this._cancel(e,n,this.event),this._cancel(e,n,this.eventOne)):(this._cancelAll(this.event),this._cancelAll(this.eventOne)):this.removeEventListener(e,t,n)}},{key:"emit",value:function(e,n,t){this._trigger(e,n,t,this.event),this._trigger(e,n,t,this.eventOne,"once")}},{key:"arrToJson",value:function(e){var n={};return e.forEach(function(e,t){e.name?n[e.name]=e:n[t]=e}),n}}]),e}()});